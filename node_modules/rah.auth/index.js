var jwt = require('express-jwt');
var settings = require('rah.settings');

function validToken(type) {
    return jwt(
        {
            secret: settings.token.secret,
            getToken: function (req) {
                switch (type) {
                    case 'header':
                        return req.headers['x-access-token'];
                    case 'cookie':
                        return req.cookies['x-access-token'];
                }
            }
        });
}

module.exports = {
    req: validToken('header'),
    cookie: validToken('cookie')
}